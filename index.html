<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pharmacie Raspail — Accès rapide</title>

  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: #f9f9f9;
      margin: 0;
      padding: 24px;
      text-align: center;
    }

    .logo {
      display: block;
      margin: 0 auto 16px auto;
      max-width: 180px;
      height: auto;
    }

    .card {
      max-width: 560px;
      margin: 0 auto;
      background: #fff;
      border: 1px solid #e6e6e6;
      border-radius: 16px;
      padding: 18px;
      box-shadow: 0 2px 10px rgba(0,0,0,.04);
      text-align: left;
    }

    h1 {
      text-align: center;
      font-size: 20px;
      margin: 0 0 14px 0;
    }

    .section {
      padding: 14px 0;
      border-top: 1px solid #f0f0f0;
    }
    .section:first-of-type { border-top: 0; }

    .label {
      font-size: 13px;
      color: #666;
      margin-bottom: 8px;
    }

    .email {
      font-size: 18px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 12px;
      background: #fff;
      word-break: break-all;
      cursor: pointer;
      user-select: none;
      text-align: center;
    }
    .email:active { background: #efefef; }

    .btnrow {
      display: grid;
      gap: 10px;
      margin-top: 10px;
    }

    .btn {
      display: inline-block;
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid #ddd;
      background: #fff;
      cursor: pointer;
      font-size: 16px;
      text-align: center;
      text-decoration: none;
      color: #111;
    }

    .status {
      margin-top: 10px;
      font-size: 13px;
      color: #333;
      text-align: center;
      min-height: 18px;
    }

    #qrcode {
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    .hint {
      font-size: 12px;
      color: #666;
      margin-top: 8px;
      text-align: center;
    }
  </style>
</head>

<body>
  <img
    src="https://pharmacology.fr/hubfs/logo-pharmacology-1.svg"
    alt="Pharmacology"
    class="logo"
  />

  <div class="card">
    <h1>Accès rapide</h1>

    <!-- EMAIL -->
    <div class="section">
      <div class="label">Copier l’email</div>

      <div class="email" id="email">pharma.raspail@gmail.com</div>

      <div class="btnrow">
        <button class="btn" id="copyEmail">Copier l’email</button>
      </div>

      <div class="status" id="statusEmail"></div>
    </div>

    <!-- WIFI -->
    <div class="section">
      <div class="label">Wi-Fi (connexion rapide)</div>

      <div class="btnrow">
        <button class="btn" id="showWifi">Afficher le QR Code Wi-Fi</button>
      </div>

      <div id="qrcode"></div>
      <div class="hint" id="wifiHint" style="display:none;">
        Scanne le QR avec l’appareil photo pour proposer la connexion au Wi-Fi.
        (Une confirmation est demandée sur iPhone/Android.)
      </div>

      <div class="status" id="statusWifi"></div>
    </div>

    <!-- AVIS GOOGLE -->
    <div class="section">
      <div class="label">Avis Google</div>

      <div class="btnrow">
        <a
          class="btn"
          id="googleReview"
          href="https://www.google.com/search?q=Pharmacie%20Raspail%20Avis&hl=fr&gl=FR&num=20&stick=H4sIAAAAAAAAAONgkxI2NjA0sjAwBQJjU2MDAzNDE8sNjIyvGCUDMhKLchOTM1MVghKLCxIzcxSCUssyU8uLF7HilgMAQroZ-FIAAAA&rldimm=3012805555353006149&tbm=lcl&cs=1&sa=X"
          target="_blank"
          rel="noopener"
        >
          Laisser un avis Google
        </a>
      </div>

      <div class="hint">Tu seras peut-être invité à te connecter à Google.</div>
    </div>
  </div>

  <!-- Génération QR -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.4/build/qrcode.min.js"></script>

  <script>
    // Haptique Android (iPhone web : pas d’API vibration)
    function haptic() {
      if (navigator.vibrate) navigator.vibrate(30);
    }

    // ---- Copier email ----
    const email = document.getElementById('email').textContent.trim();
    const statusEmail = document.getElementById('statusEmail');

    async function copyEmail() {
      try {
        await navigator.clipboard.writeText(email);
        haptic();
        statusEmail.textContent = "✅ Email copié";
        // Optionnel : effacer le message après 2s
        setTimeout(() => { statusEmail.textContent = ""; }, 2000);
      } catch {
        statusEmail.textContent = "❌ Copie impossible. Maintiens appuyé puis “Copier”.";
      }
    }

    document.getElementById('email').addEventListener('click', copyEmail);
    document.getElementById('copyEmail').addEventListener('click', copyEmail);

    // ---- QR Wi-Fi ----
    const WIFI_SSID = "MimounWifi";
    const WIFI_PASS = "Mimoun55";
    const WIFI_TYPE = "WPA"; // WPA / WEP / nopass
    const statusWifi = document.getElementById('statusWifi');

    function wifiPayload() {
      // Format standard : WIFI:T:WPA;S:MonWifi;P:MonPass;;
      const esc = (s) => String(s).replace(/([\\;,:"])/g, "\\$1");
      return `WIFI:T:${WIFI_TYPE};S:${esc(WIFI_SSID)};P:${esc(WIFI_PASS)};;`;
    }

    document.getElementById('showWifi').addEventListener('click', async () => {
      const box = document.getElementById('qrcode');
      box.innerHTML = "";
      document.getElementById('wifiHint').style.display = "block";

      try {
        const canvas = document.createElement("canvas");
        await QRCode.toCanvas(canvas, wifiPayload(), { width: 220, margin: 1 });
        box.appendChild(canvas);
        haptic();
        statusWifi.textContent = "✅ QR Wi-Fi prêt";
        setTimeout(() => { statusWifi.textContent = ""; }, 2000);
      } catch {
        statusWifi.textContent = "❌ Impossible de générer le QR Wi-Fi.";
      }
    });
  </script>
</body>
</html>
